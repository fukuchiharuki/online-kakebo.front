(this["webpackJsonponline-kakebo.front"]=this["webpackJsonponline-kakebo.front"]||[]).push([[0],{26:function(t,e,n){},28:function(t,e,n){},30:function(t,e,n){},31:function(t,e,n){},37:function(t,e,n){"use strict";n.r(e);var r=n(1),c=n.n(r),i=n(18),u=n.n(i),a=(n(26),n(10)),s=n(13),o=n.n(s),l=n(19);var h,f=function(t,e,n){var c=Object(r.useState)(null),i=Object(a.a)(c,2),u=i[0],s=i[1],h=Object(r.useState)(!1),f=Object(a.a)(h,2),j=f[0];return function(t,e){var n=e||{},c=n.preProcess,i=n.postProcess,u=n.errorHandler;Object(r.useEffect)((function(){Object(l.a)(o.a.mark((function e(){var n,r;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return c&&c(),console.log("get ".concat(t)),e.next=4,fetch(t);case 4:if(!(n=e.sent).ok){e.next=13;break}return e.next=8,n.json();case 8:r=e.sent,i&&i(r),console.log("ok"),e.next=15;break;case 13:u&&u(n.status),console.log("error");case 15:case"end":return e.stop()}}),e)})))()}),[t,c,i,u])}(t,function(t,e,n,c){return function(t,e){var n=t||{},c=n.preProcess,i=n.postProcess,u=n.errorHandler,a=e||{},s=a.preProcess,o=a.postProcess,l=a.errorHandler;return{preProcess:Object(r.useCallback)((function(){c&&c(),s&&s()}),[c,s]),postProcess:Object(r.useCallback)((function(t){i&&i(t),o&&o(t)}),[i,o]),errorHandler:Object(r.useCallback)((function(t){u&&u(t),l&&l(t)}),[u,l])}}({preProcess:Object(r.useCallback)((function(){e(!0)}),[e]),postProcess:Object(r.useCallback)((function(r){t(n(r)),e(!1)}),[n,t,e])},c)}(s,f[1],function(t){var e=Object(r.useCallback)((function(t){return t}),[]);return t||e}(e),n)),{isLoading:j,data:u}},j=n(2),d=n(3),v=function(){function t(e){Object(j.a)(this,t),this.length=void 0,this.length=e}return Object(d.a)(t,[{key:"hasNext",value:function(t){return this.isInRange(t+1)}},{key:"hasPrev",value:function(t){return this.isInRange(t-1)}},{key:"isInRange",value:function(t){return-this.length<t&&t<=0}}]),t}(),b=n(5);!function(t){t["\u98df\u8cbb"]="\u98df\u8cbb",t["\u98df\u8cbb_\u500b\u5225"]="\u98df\u8cbb(\u500b\u5225)",t["\u65e5\u7528\u54c1\u8cbb"]="\u65e5\u7528\u54c1\u8cbb",t["\u5a2f\u697d\u8cbb"]="\u5a2f\u697d\u8cbb",t["\u533b\u7642\u8cbb"]="\u533b\u7642\u8cbb",t["\u6c34\u9053\u5149\u71b1\u8cbb"]="\u6c34\u9053\u5149\u71b1\u8cbb",t["\u901a\u4fe1\u8cbb"]="\u901a\u4fe1\u8cbb",t["\u4f4f\u5c45\u8cbb"]="\u4f4f\u5c45\u8cbb",t["\u7279\u5225\u8cbb"]="\u7279\u5225\u8cbb",t["\u5143\u5165\u91d1"]="\u5143\u5165\u91d1"}(h||(h={}));function O(t){switch(t){case h.\u98df\u8cbb:case h.\u98df\u8cbb_\u500b\u5225:return{"is\u53ce\u5165":function(){return!1},"is\u7279\u5225\u8cbb":function(){return!1},category:function(){return h.\u98df\u8cbb}};case h.\u65e5\u7528\u54c1\u8cbb:return{"is\u53ce\u5165":function(){return!1},"is\u7279\u5225\u8cbb":function(){return!1},category:function(){return h.\u65e5\u7528\u54c1\u8cbb}};case h.\u5a2f\u697d\u8cbb:return{"is\u53ce\u5165":function(){return!1},"is\u7279\u5225\u8cbb":function(){return!1},category:function(){return h.\u5a2f\u697d\u8cbb}};case h.\u533b\u7642\u8cbb:return{"is\u53ce\u5165":function(){return!1},"is\u7279\u5225\u8cbb":function(){return!1},category:function(){return h.\u533b\u7642\u8cbb}};case h.\u6c34\u9053\u5149\u71b1\u8cbb:return{"is\u53ce\u5165":function(){return!1},"is\u7279\u5225\u8cbb":function(){return!1},category:function(){return h.\u6c34\u9053\u5149\u71b1\u8cbb}};case h.\u901a\u4fe1\u8cbb:return{"is\u53ce\u5165":function(){return!1},"is\u7279\u5225\u8cbb":function(){return!1},category:function(){return h.\u901a\u4fe1\u8cbb}};case h.\u4f4f\u5c45\u8cbb:return{"is\u53ce\u5165":function(){return!1},"is\u7279\u5225\u8cbb":function(){return!1},category:function(){return h.\u4f4f\u5c45\u8cbb}};case h.\u7279\u5225\u8cbb:return{"is\u53ce\u5165":function(){return!1},"is\u7279\u5225\u8cbb":function(){return!0},category:function(){return h.\u7279\u5225\u8cbb}};case h.\u5143\u5165\u91d1:return{"is\u53ce\u5165":function(){return!0},"is\u7279\u5225\u8cbb":function(){return!1},category:function(){return h.\u5143\u5165\u91d1}}}}var x=function(){function t(e){Object(j.a)(this,t),this.accountItem=void 0,this.amount=void 0,Object.assign(this,e)}return Object(d.a)(t,[{key:"category",value:function(){return O(this.accountItem).category()}},{key:"categoryIs",value:function(t){return this.category()===t}},{key:"is",value:function(t){return this.accountItem===t}},{key:"is\u53ce\u5165",value:function(){return O(this.accountItem).is\u53ce\u5165()}},{key:"is\u7279\u5225\u8cbb",value:function(){return O(this.accountItem).is\u7279\u5225\u8cbb()}}]),t}(),g=function(){function t(e){Object(j.a)(this,t),this.value=void 0,this.value=e}return Object(d.a)(t,[{key:"\u53ce\u5165",value:function(){return this.value.filter\u53ce\u5165().totalAmount()}},{key:"\u652f\u51fa",value:function(){return this.value.filter\u652f\u51fa().totalAmount()}},{key:"\u7279\u5225\u8cbb",value:function(){return this.value.filter\u7279\u5225\u8cbb().totalAmount()}},{key:"\u7279\u5225\u8cbb\u3092\u9664\u3044\u305f\u652f\u51fa",value:function(){return this.\u652f\u51fa()-this.\u7279\u5225\u8cbb()}},{key:"\u7279\u5225\u8cbb\u3092\u542b\u3081\u306a\u3044\u5dee\u5f15",value:function(){return this.\u53ce\u5165()-this.\u7279\u5225\u8cbb\u3092\u9664\u3044\u305f\u652f\u51fa()}},{key:"\u7279\u5225\u8cbb\u3092\u542b\u3081\u305f\u5dee\u5f15",value:function(){return this.\u53ce\u5165()-this.\u652f\u51fa()}}],[{key:"of",value:function(e){return new t(e)}}]),t}(),m=function(){function t(e){var n;Object(j.a)(this,t),this.month=void 0,this.data=void 0,Object.assign(this,Object(b.a)(Object(b.a)({},e),{},{data:null===(n=e.data)||void 0===n?void 0:n.map((function(t){return new x(t)}))}))}return Object(d.a)(t,[{key:"asSummary",value:function(){return g.of(this)}},{key:"totalAmount",value:function(){return this.data.map((function(t){return t.amount})).reduce((function(t,e){return t+e}),0)}},{key:"categories",value:function(){return this.data.map((function(t){return t.category()})).reduce((function(t,e){return t.includes(e)?t:t.concat(e)}),[])}},{key:"filterByCategory",value:function(e){return new t({month:this.month,data:this.data.filter((function(t){return t.categoryIs(e)}))})}},{key:"filterByAccountItemType",value:function(e){return new t({month:this.month,data:this.data.filter((function(t){return t.is(e)}))})}},{key:"filter\u53ce\u5165",value:function(){return new t({month:this.month,data:this.data.filter((function(t){return t.is\u53ce\u5165()}))})}},{key:"filter\u652f\u51fa",value:function(){return new t({month:this.month,data:this.data.filter((function(t){return!t.is\u53ce\u5165()}))})}},{key:"filter\u7279\u5225\u8cbb",value:function(){return new t({month:this.month,data:this.data.filter((function(t){return t.is\u7279\u5225\u8cbb()}))})}}]),t}(),y=function(){function t(e){var n;Object(j.a)(this,t),this.values=void 0,Object.assign(this,{values:null===(n=e.values)||void 0===n?void 0:n.map((function(t){return new m(t)}))})}return Object(d.a)(t,[{key:"isEmpty",value:function(){return 0===this.values.length}},{key:"cursorRange",value:function(){return new v(this.values.length)}},{key:"cursorMonth",value:function(t){return this.values.slice(t-1)[0]}},{key:"currentMonth",value:function(){return this.cursorMonth(0)}}],[{key:"empty",value:function(){return new t({values:[]})}}]),t}();var k=function(t){var e=t.aggregation(),n=Object(r.useCallback)((function(t){return new y({values:t})}),[]);return f(e,n)},p=(n(28),n(0));function w(t){return Object(p.jsx)("div",Object(b.a)({className:"center"},t))}var C=n(7),P=function(){function t(e){Object(j.a)(this,t),this.script=void 0,this.data=void 0,Object.assign(this,e)}return Object(d.a)(t,[{key:"aggregation",value:function(){return this.url("aggregation")}},{key:"url",value:function(t){return"https://script.google.com/macros/s/".concat(this.script,"/exec?resource=").concat(t,"&id=").concat(this.data)}}]),t}(),S=function(){function t(e){Object(j.a)(this,t),this.search=void 0,this.search=e}return Object(d.a)(t,[{key:"validate",value:function(){var t=new URLSearchParams(this.search);return!![t.get("script"),t.get("data")].reduce((function(t,e){return t&&e}))}},{key:"dataSource",value:function(){var t=new URLSearchParams(this.search),e=t.get("script"),n=t.get("data");return new P({script:e,data:n})}}]),t}();n(30);function N(t){return Object(p.jsx)("div",Object(b.a)({className:"fade-in"},t))}n(31);function M(){return Object(p.jsx)("div",{children:Object(p.jsx)("div",{className:"loader",children:"Loading..."})})}var I=function(t){if(t.if)return Object(p.jsx)(M,{});var e="function"===typeof t.children?t.children():t.children;return Object(p.jsx)(N,{children:e})},F=n(9),R=function(){function t(){Object(j.a)(this,t),this.value=void 0,this.value=new Date}return Object(d.a)(t,[{key:"restOfCurrentMonth",value:function(){var t=new Date(this.value.getFullYear(),this.value.getMonth()+1,0);return Math.ceil((t.getTime()-this.value.getTime())/864e5)}},{key:"cursorMonth",value:function(t){for(var e=new Date(this.value.getTime()),n=0;n>t;n--)e.setDate(0);return[e.getFullYear(),e.getMonth()+1]}}]),t}();var A=function(t){var e=t.cursorParams,n=t.cursorRange,r=t.onPrevClick,c=t.onNextClick,i=(e.hasPrev(n)?["flip"]:["flip","flip--disabled"]).join(" ");return Object(p.jsxs)("div",{className:"month-cursor",children:[Object(p.jsx)("div",{className:i,onClick:r,children:"\u25c0"}),Object(p.jsxs)("div",{children:[Object(p.jsx)("h2",{children:"\u4eca\u6708"}),Object(p.jsxs)("p",{children:["(\u6b8b\u308a ",(new R).restOfCurrentMonth()," \u65e5)"]})]}),Object(p.jsx)("div",{className:"flip flip--disabled",onClick:c,children:"\u25b6"})]})},L=function(){function t(e){Object(j.a)(this,t),this.search=void 0,this.search=e}return Object(d.a)(t,[{key:"isCurrentMonth",value:function(){return 0===this.cursor()}},{key:"cursor",value:function(){var t=new URLSearchParams(this.search);return parseInt(t.get("cursor"))||0}},{key:"hasNext",value:function(t){return t.hasNext(this.cursor())}},{key:"hasPrev",value:function(t){return t.hasPrev(this.cursor())}},{key:"nextSearch",value:function(){return this.offsetSearch(1)}},{key:"prevSearch",value:function(){return this.offsetSearch(-1)}},{key:"offsetSearch",value:function(t){var e=new URLSearchParams(this.search);return e.set("cursor",(this.cursor()+t).toString()),e.toString()}}]),t}();var B=function(t){return Object(p.jsx)(r.Fragment,{children:t.children.toLocaleString()})};var T=function(t){if(!t.if)return null;var e="function"===typeof t.children?t.children():t.children;return Object(p.jsx)(r.Fragment,{children:e})};var D=function(t){return Object(p.jsx)(r.Fragment,{children:t.in.map(t.children).map((function(t,e){return Object(p.jsx)(r.Fragment,{children:t},e)}))})};var E=function(t){var e=t.children;return Object(p.jsx)("dl",{className:"monthly-details",children:Object(p.jsx)(D,{in:e.categories(),children:function(t){var n=e.filterByCategory(t).totalAmount(),c=e.filterByAccountItemType(t).totalAmount(),i=n!==c;return Object(p.jsxs)(r.Fragment,{children:[Object(p.jsxs)("dt",{children:[t,Object(p.jsx)(T,{if:i,children:"*"})]}),Object(p.jsx)("dd",{children:Object(p.jsx)(B,{children:n})}),Object(p.jsx)(T,{if:i,children:Object(p.jsxs)("dd",{children:["(*\u5185 \u7d14\u7c8b\u306a",t,": ",Object(p.jsx)(B,{children:c}),")"]})})]})}})})};var H=function(t){var e=t.children;return Object(p.jsxs)("dl",{className:"monthly-summary",children:[Object(p.jsx)("dt",{children:"\u53ce\u5165"}),Object(p.jsx)("dd",{children:Object(p.jsx)(B,{children:e.\u53ce\u5165()})}),Object(p.jsx)("dt",{children:"\u652f\u51fa"}),Object(p.jsx)("dd",{children:Object(p.jsx)(B,{children:e.\u7279\u5225\u8cbb\u3092\u9664\u3044\u305f\u652f\u51fa()})}),Object(p.jsxs)(T,{if:e.\u7279\u5225\u8cbb(),children:[Object(p.jsxs)("dd",{children:["+ \u7279\u5225\u8cbb: ",Object(p.jsx)(B,{children:e.\u7279\u5225\u8cbb()})]}),Object(p.jsxs)("dd",{children:["= \u8a08: ",Object(p.jsx)(B,{children:e.\u652f\u51fa()})]})]}),Object(p.jsx)("dt",{children:"\u5dee\u5f15"}),Object(p.jsx)("dd",{children:Object(p.jsx)(B,{children:e.\u7279\u5225\u8cbb\u3092\u542b\u3081\u306a\u3044\u5dee\u5f15()})}),Object(p.jsxs)(T,{if:e.\u7279\u5225\u8cbb(),children:[Object(p.jsxs)("dd",{children:["- \u7279\u5225\u8cbb: ",Object(p.jsx)(B,{children:e.\u7279\u5225\u8cbb()})]}),Object(p.jsxs)("dd",{children:["= \u8a08: ",Object(p.jsx)(B,{children:e.\u7279\u5225\u8cbb\u3092\u542b\u3081\u305f\u5dee\u5f15()})]})]})]})};var U=function(t){var e=t.monthCursor,n=t.monthlyAggregation;return Object(p.jsxs)("div",{children:[e,Object(p.jsx)(H,{children:n.asSummary()}),Object(p.jsx)("h3",{children:"\u5185\u8a33"}),Object(p.jsx)(E,{children:n})]})};var J=function(t){var e=t.cursorParams,n=t.cursorRange,r=t.onPrevClick,c=t.onNextClick,i=(e.hasPrev(n)?["flip"]:["flip","flip--disabled"]).join(" "),u=(e.hasNext(n)?["flip"]:["flip","flip--disabled"]).join(" "),s=(new R).cursorMonth(e.cursor()),o=Object(a.a)(s,2),l=o[0],h=o[1];return Object(p.jsxs)("div",{className:"month-cursor",children:[Object(p.jsx)("div",{className:i,onClick:r,children:"\u25c0"}),Object(p.jsxs)("div",{children:[Object(p.jsx)("h2",{children:-1===e.cursor()?"\u5148\u6708":-2===e.cursor()?"\u5148\u3005\u6708":"".concat(-e.cursor()," \u30f6\u6708\u524d")}),Object(p.jsxs)("p",{children:["(",l," \u5e74 ",h," \u6708)"]})]}),Object(p.jsx)("div",{className:u,onClick:c,children:"\u25b6"})]})};var K=function(t){var e=t.state,n=e.isLoading,r=e.data,c=Object(F.c)(),i=Object(F.d)(),u=new L(i.search);return Object(p.jsx)(I,{if:n||null==r,children:function(){var t=r,e=t.cursorRange(),n={cursorParams:u,cursorRange:e,onPrevClick:function(){return c.push({pathname:".",search:u.prevSearch()})},onNextClick:function(){return c.push({pathname:".",search:u.nextSearch()})}},i={monthCursor:u.isCurrentMonth()?Object(p.jsx)(A,Object(b.a)({},n)):Object(p.jsx)(J,Object(b.a)({},n)),monthlyAggregation:u.isCurrentMonth()?t.currentMonth():t.cursorMonth(u.cursor())};return Object(p.jsx)(U,Object(b.a)({},i))}})},Y=Object(C.a)();function _(){return console.error("invalid parameters."),Object(p.jsx)(w,{children:"\u0e50\xb7\xb0(\u09f9\u02c3\u15dd\u02c2\u09f9)\xb0\xb7\u0e50"})}function q(t){var e=t.dataSource,n=k(e);return Object(p.jsxs)(r.Fragment,{children:[Object(p.jsxs)("header",{children:[Object(p.jsx)("h1",{children:"Online KAKEBO"}),Object(p.jsx)("div",{className:"reload",onClick:function(){return window.location.reload()},children:"\u21bb"})]}),Object(p.jsx)("hr",{}),Object(p.jsx)(F.b,{history:Y,children:Object(p.jsx)(F.a,{path:"/",render:z(n)})})]})}function z(t){return function(){return Object(p.jsx)(K,{state:t})}}var G=function(){var t=new S(Y.location.search);if(!t.validate())return Object(p.jsx)(_,{});var e=t.dataSource();return Object(p.jsx)(q,{dataSource:e})},Q=function(t){t&&t instanceof Function&&n.e(3).then(n.bind(null,38)).then((function(e){var n=e.getCLS,r=e.getFID,c=e.getFCP,i=e.getLCP,u=e.getTTFB;n(t),r(t),c(t),i(t),u(t)}))};u.a.render(Object(p.jsx)(c.a.StrictMode,{children:Object(p.jsx)(G,{})}),document.getElementById("root")),Q()}},[[37,1,2]]]);
//# sourceMappingURL=main.fd1933b8.chunk.js.map