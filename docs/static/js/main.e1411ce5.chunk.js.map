{"version":3,"sources":["model/aggregation/AccountItemType.ts","model/aggregation/useModel.ts","model/aggregation/AccountItem.ts","model/aggregation/MonthlySummary.ts","model/aggregation/MonthlyAggregation.ts","model/aggregation/Aggregation.ts","model/aggregation/useQuery.ts","infrastructure/useFetch.ts","ui/Amount.tsx","ui/Mount.tsx","model/aggregation/view/MonthlySummaryView.tsx","infrastructure/DataSource.ts","ui/Repeat.tsx","model/aggregation/view/MonthlyDetailsView.tsx","model/date/Today.ts","ui/Loading.tsx","ui/FadeIn.tsx","ui/OrLoading.tsx","page/Dashboard.tsx","App.tsx","reportWebVitals.ts","index.tsx"],"names":["AccountItemType","specOf","accountItemType","食費","食費_個別","is収入","is特別費","category","日用品費","娯楽費","医療費","水道光熱費","通信費","住居費","特別費","元入金","ActionType","AccountItem","init","accountItem","amount","Object","assign","this","MonthlySummary","value","filter収入","totalAmount","filter支出","filter特別費","支出","収入","特別費を除いた支出","MonthlyAggregation","month","data","map","it","of","reduce","acc","includes","concat","filter","categoryIs","is","Aggregation","values","length","slice","initialState","isLoading","empty","reducer","state","action","type","FETCH","FETCHED","payload","json","useQuery","dataSource","url","aggregation","useReducer","dispatch","callback","preProcess","postProcess","errorHandler","useEffect","a","fetch","response","ok","useFetch","useCallback","fetchedAction","Amount","props","children","toLocaleString","Mount","if","MonthlySummaryView","monthlySummary","className","特別費を含めた差引","DataSource","script","resource","Repeat","in","i","MonthlyDetailsView","monthlyAggregation","categories","categoryTotalAmount","filterByCategory","acountItemTypeAmount","filterByAccountItemType","diff","Today","Date","endOfCurrentMonth","getFullYear","getMonth","Math","ceil","getTime","Loading","FadeIn","OrLoading","Dashboard","dataSouce","search","urlSearchParams","URLSearchParams","get","location","isEmpty","currentMonthAggregation","currentMonth","restOfCurrentMonth","asSummary","history","createBrowserHistory","dashboard","App","path","render","reportWebVitals","onPerfEntry","Function","then","getCLS","getFID","getFCP","getLCP","getTTFB","ReactDOM","StrictMode","document","getElementById"],"mappings":"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","file":"static/js/main.e1411ce5.chunk.js","sourcesContent":["enum AccountItemType {\n  食費 = \"食費\",\n  食費_個別 = \"食費(個別)\",\n  日用品費 = \"日用品費\",\n  娯楽費 = \"娯楽費\",\n  医療費 = \"医療費\",\n  水道光熱費 = \"水道光熱費\",\n  通信費 = \"通信費\",\n  住居費 = \"住居費\",\n  特別費 = \"特別費\",\n  元入金 = \"元入金\"\n}\n\nexport default AccountItemType;\n\nexport function specOf(accountItemType: AccountItemType) {\n  switch (accountItemType) {\n    case AccountItemType.食費:\n      return { is収入: () => false, is特別費: () => false, category: () => AccountItemType.食費 };\n    case AccountItemType.食費_個別:\n      return { is収入: () => false, is特別費: () => false, category: () => AccountItemType.食費 };\n    case AccountItemType.日用品費:\n      return { is収入: () => false, is特別費: () => false, category: () => AccountItemType.日用品費 };\n    case AccountItemType.娯楽費:\n      return { is収入: () => false, is特別費: () => false, category: () => AccountItemType.娯楽費 };\n    case AccountItemType.医療費:\n      return { is収入: () => false, is特別費: () => false, category: () => AccountItemType.医療費 };\n    case AccountItemType.水道光熱費:\n      return { is収入: () => false, is特別費: () => false, category: () => AccountItemType.水道光熱費 };\n    case AccountItemType.通信費:\n      return { is収入: () => false, is特別費: () => false, category: () => AccountItemType.通信費 };\n    case AccountItemType.住居費:\n      return { is収入: () => false, is特別費: () => false, category: () => AccountItemType.住居費 };\n    case AccountItemType.特別費:\n      return { is収入: () => false, is特別費: () => true, category: () => AccountItemType.特別費 };\n    case AccountItemType.元入金:\n      return { is収入: () => true, is特別費: () => false, category: () => AccountItemType.元入金 };\n  }\n}\n","import { useReducer } from 'react';\nimport Aggregation from './Aggregation';\nimport RemoteResource from 'infrastructure/RemoteResource';\n\nenum ActionType {\n  FETCH,\n  FETCHED\n}\n\ninterface FetchAction {\n  type: typeof ActionType.FETCH;\n}\n\nexport function fetchAction(): FetchAction {\n  return { type: ActionType.FETCH };\n}\n\ninterface FetchedAction {\n  type: typeof ActionType.FETCHED;\n  payload: { json: any; };\n}\n\nexport function fetchedAction(json: any): FetchedAction {\n  return { type: ActionType.FETCHED, payload: { json } };\n}\n\ntype State = RemoteResource & {\n  data: Aggregation;\n}\n\nconst initialState = {\n  isLoading: false,\n  data: Aggregation.empty()\n};\n\ntype Action = FetchAction | FetchedAction;\n\nfunction reducer(state: State, action: Action): State {\n  switch (action.type) {\n    case ActionType.FETCH:\n      return { ...state, isLoading: true };\n    case ActionType.FETCHED:\n      const data = new Aggregation({ values: action.payload.json });\n      return { ...state, data, isLoading: false };\n  }\n}\n\nexport default function useModel() {\n  return useReducer(reducer, initialState);\n}\n","import AccountItemType, { specOf } from \"./AccountItemType\";\n\nexport default class AccountItem {\n  accountItem!: AccountItemType;\n  amount!: number;\n\n  constructor(init: Partial<AccountItem>) {\n    Object.assign(this, init);\n  }\n\n  category(): AccountItemType {\n    return specOf(this.accountItem).category();\n  }\n\n  categoryIs(accountItemType: AccountItemType): boolean {\n    return this.category() === accountItemType;\n  }\n\n  is(accountItemType: AccountItemType): boolean {\n    return this.accountItem === accountItemType;\n  }\n\n  is収入(): boolean {\n    return specOf(this.accountItem).is収入();\n  }\n\n  is特別費(): boolean {\n    return specOf(this.accountItem).is特別費();\n  }\n}\n","import MonthlyAggregation from \"./MonthlyAggregation\";\n\nexport default class MonthlySummary {\n  value!: MonthlyAggregation;\n\n  private constructor(init: MonthlyAggregation) {\n    this.value = init;\n  }\n\n  static of(init: MonthlyAggregation): MonthlySummary {\n    return new MonthlySummary(init);\n  }\n\n  収入() {\n    return this.value.filter収入().totalAmount();\n  }\n\n  支出() {\n    return this.value.filter支出().totalAmount();\n  }\n\n  特別費() {\n    return this.value.filter特別費().totalAmount();\n  }\n\n  特別費を除いた支出() {\n    return this.支出() - this.特別費();\n  }\n\n  特別費を含めない差引() {\n    return this.収入() - this.特別費を除いた支出();\n  }\n\n  特別費を含めた差引() {\n    return this.収入() - this.支出();\n  }\n}\n","import AccountItem from \"./AccountItem\";\nimport AccountItemType from \"./AccountItemType\";\nimport MonthlySummary from './MonthlySummary';\n\nexport default class MonthlyAggregation {\n  month!: string;\n  data!: AccountItem[];\n\n  constructor(init: Partial<MonthlyAggregation>) {\n    Object.assign(this, { ...init, data: init.data?.map(it => new AccountItem(it)) });\n  }\n\n  asSummary(): MonthlySummary {\n    return MonthlySummary.of(this)\n  }\n\n  totalAmount(): number {\n    return this.data\n      .map(it => it.amount)\n      .reduce((acc, amount) => acc + amount, 0);\n  }\n\n  categories(): AccountItemType[] {\n    return this.data\n      .map(it => it.category())\n      .reduce((acc, category) => acc.includes(category) ? acc : acc.concat(category), [] as AccountItemType[])\n  }\n\n  filterByCategory(accountItemType: AccountItemType): MonthlyAggregation {\n    return new MonthlyAggregation({\n      month: this.month,\n      data: this.data.filter(it => it.categoryIs(accountItemType))\n    });\n  }\n\n  filterByAccountItemType(accountItemType: AccountItemType): MonthlyAggregation {\n    return new MonthlyAggregation({\n      month: this.month,\n      data: this.data.filter(it => it.is(accountItemType))\n    });\n  }\n\n  filter収入(): MonthlyAggregation {\n    return new MonthlyAggregation({\n      month: this.month,\n      data: this.data.filter(it => it.is収入())\n    });\n  }\n\n  filter支出(): MonthlyAggregation {\n    return new MonthlyAggregation({\n      month: this.month,\n      data: this.data.filter(it => !it.is収入())\n    });\n  }\n\n  filter特別費(): MonthlyAggregation {\n    return new MonthlyAggregation({\n      month: this.month,\n      data: this.data.filter(it => it.is特別費())\n    });\n  }\n}\n","import MonthlyAggregation from \"./MonthlyAggregation\";\n\nexport default class Aggregation {\n  values!: MonthlyAggregation[];\n\n  constructor(init: Partial<Aggregation>) {\n    Object.assign(this, { values: init.values?.map(it => new MonthlyAggregation(it)) });\n  }\n\n  static empty(): Aggregation {\n    return new Aggregation({ values: [] });\n  }\n\n  isEmpty(): boolean {\n    return this.values.length === 0;\n  }\n\n  currentMonth(): MonthlyAggregation {\n    return this.values.slice(-1)[0];\n  }\n}\n","import { useCallback } from \"react\";\nimport DataSource from \"infrastructure/DataSource\";\nimport useModel, { fetchAction, fetchedAction } from './useModel';\nimport useFetch from 'infrastructure/useFetch';\nimport { Callback } from \"infrastructure/useFetch\";\n\nfunction useQuery(dataSource: DataSource) {\n  const url = dataSource.aggregation();\n  const [state, dispatch] = useModel();\n  const callback: Callback = {\n    preProcess: useCallback(() => dispatch(fetchAction()), []),\n    postProcess: useCallback((json) => dispatch(fetchedAction(json)), [])\n  }\n  useFetch(url, callback);\n  return state;\n}\n\nexport default useQuery;\n","import { useEffect } from \"react\";\n\nexport default function useFetch(\n  url: string,\n  callback: Callback\n) {\n  const { preProcess, postProcess, errorHandler } = callback;\n  useEffect(() => {\n    (async () => {\n      preProcess && preProcess();\n      const response = await fetch(url);\n      if (response.ok) {\n        const json = await response.json();\n        postProcess && postProcess(json);\n      } else {\n        errorHandler && errorHandler();\n      }\n    })();\n  }, [url, preProcess, postProcess, errorHandler]);\n}\n\nexport type Callback = {\n  preProcess?: () => void\n  postProcess?: (json: any) => void\n  errorHandler?: () => void\n};\n","import { Fragment } from \"react\";\n\ntype Props = {\n  children: number\n};\n\nfunction Amount(props: Props) {\n  return (\n    <Fragment>{props.children.toLocaleString()}</Fragment>\n  );\n}\n\nexport default Amount;\n","import { Fragment } from \"react\";\n\ntype Props = {\n  if: any,\n  children: any\n};\n\nfunction Mount(props: Props) {\n  if (!props.if) return null;\n  const children =\n    (typeof props.children === \"function\")\n      ? props.children()\n      : props.children;\n  return <Fragment>{children}</Fragment>;\n}\n\nexport default Mount;\n","import MonthlySummary from '../MonthlySummary';\nimport Amount from 'ui/Amount';\nimport Mount from 'ui/Mount';\n\ntype Props = {\n  children: MonthlySummary\n};\n\nfunction MonthlySummaryView(props: Props) {\n  const monthlySummary = props.children;\n  return (\n    <dl className=\"monthly-summary\">\n      <dt>収入</dt>\n      <dd><Amount>{monthlySummary.収入()}</Amount></dd>\n      <dt>支出</dt>\n      <dd><Amount>{monthlySummary.特別費を除いた支出()}</Amount></dd>\n      <Mount if={monthlySummary.特別費()}>\n        <dd>(+ 特別費: <Amount>{monthlySummary.特別費()}</Amount>)</dd>\n      </Mount>\n      <dt>差引</dt>\n      <dd><Amount>{monthlySummary.特別費を含めた差引()}</Amount></dd>\n      <Mount if={monthlySummary.特別費()}>\n        <dd>(特別費込: <Amount>{monthlySummary.特別費を含めた差引()}</Amount>)</dd>\n      </Mount>\n    </dl>\n  );\n}\n\nexport default MonthlySummaryView;\n","export default class DataSource {\n  script!: string;\n  data!: string;\n\n  constructor(init: Partial<DataSource>) {\n    Object.assign(this, init);\n  }\n\n  aggregation(): string {\n    return this.url(\"aggregation\");\n  }\n\n  private url(resource: string): string {\n    return `https://script.google.com/macros/s/${this.script}/exec?resource=${resource}&id=${this.data}`;\n  }\n}\n","import { Fragment } from \"react\";\n\ntype Props<T> = {\n  in: T[],\n  children: (it: T) => any\n};\n\nfunction Repeat<T>(props: Props<T>) {\n  return <Fragment>{props.in.map(props.children).map((it, i) => <Fragment key={i}>{it}</Fragment>)}</Fragment>\n}\n\nexport default Repeat;\n","import { Fragment } from 'react';\nimport MonthlyAggregation from '../MonthlyAggregation';\nimport Repeat from 'ui/Repeat';\nimport Amount from 'ui/Amount';\nimport Mount from 'ui/Mount';\n\ntype Props = {\n  children: MonthlyAggregation\n};\n\nfunction MonthlyDetailsView(props: Props) {\n  const monthlyAggregation = props.children;\n  return (\n    <dl className=\"monthly-details\">\n      <Repeat in={monthlyAggregation.categories()}>{it => {\n        const categoryTotalAmount = monthlyAggregation.filterByCategory(it).totalAmount();\n        const acountItemTypeAmount = monthlyAggregation.filterByAccountItemType(it).totalAmount();\n        const diff = categoryTotalAmount !== acountItemTypeAmount;\n        return (\n          <Fragment>\n            <dt>{it}<Mount if={diff}>*</Mount></dt>\n            <dd><Amount>{categoryTotalAmount}</Amount></dd>\n            <Mount if={diff}>\n              <dd>(*内 純粋な{it}: <Amount>{acountItemTypeAmount}</Amount>)</dd>\n            </Mount>\n          </Fragment>\n        );\n      }}</Repeat>\n    </dl>\n  );\n}\n\nexport default MonthlyDetailsView;\n","class Today {\n  value!: Date;\n\n  constructor() {\n    this.value = new Date();\n  }\n\n  restOfCurrentMonth(): number {\n    const endOfCurrentMonth = new Date(this.value.getFullYear(), this.value.getMonth() + 1, 0);\n    return Math.ceil((endOfCurrentMonth.getTime() - this.value.getTime()) / (24 * 60 * 60 * 1000));\n  }\n}\n\nexport default Today;\n","import './Loading.scss';\n\nexport default function Loading() {\n  return <div><div className=\"loader\">Loading...</div></div>;\n}\n","import './FadeIn.scss';\n\ntype Props = {\n  children: any\n};\n\nexport default function FadeIn(props: Props) {\n  return <div className=\"fade-in\" {...props}></div>;\n}\n","import Loading from \"./Loading\";\nimport FadeIn from './FadeIn';\n\ntype Props = {\n  if: any,\n  children: any\n};\n\nfunction OrLoading(props: Props) {\n  if (props.if) return <Loading />;\n  const children =\n    (typeof props.children === \"function\")\n      ? props.children()\n      : props.children;\n  return <FadeIn>{children}</FadeIn>;\n}\n\nexport default OrLoading;\n","import { Fragment } from 'react';\nimport { RouterProps } from 'App';\nimport useQuery from 'model/aggregation/useQuery';\nimport MonthlySummaryView from 'model/aggregation/view/MonthlySummaryView';\nimport DataSource from 'infrastructure/DataSource';\nimport MonthlyDetailsView from 'model/aggregation/view/MonthlyDetailsView';\nimport Today from 'model/date/Today';\nimport OrLoading from 'ui/OrLoading';\n\ntype Props = RouterProps;\n\nfunction Dashboard(props: Props) {\n  const dataSouce = dataSource(props.location.search);\n  const { isLoading, data } = useQuery(dataSouce);\n  return (\n    <Fragment>\n      <header>\n        <h1>Online KAKEBO</h1>\n      </header>\n      <hr />\n      <OrLoading if={isLoading || data.isEmpty()}>{() => {\n        const currentMonthAggregation = data.currentMonth();\n        return (\n          <div>\n            <h2>今月</h2>\n            <p>(残り {new Today().restOfCurrentMonth()} 日)</p>\n            <MonthlySummaryView>{currentMonthAggregation.asSummary()}</MonthlySummaryView>\n            <h3>内訳</h3>\n            <MonthlyDetailsView>{currentMonthAggregation}</MonthlyDetailsView>\n          </div>\n        );\n      }}</OrLoading>\n    </Fragment>\n  );\n}\n\nfunction dataSource(search: string): DataSource {\n  const urlSearchParams = new URLSearchParams(search)\n  const script = urlSearchParams.get(\"script\")!;\n  const data = urlSearchParams.get(\"data\")!;\n  return new DataSource({ script, data });\n}\n\nexport default Dashboard;\n","import { Route, Router } from 'react-router';\nimport { createBrowserHistory } from \"history\";\nimport Dashboard from 'page/Dashboard';\n\nconst history = createBrowserHistory();\n\nfunction App() {\n  return (\n    <Router history={history}>\n      <Route path=\"/\" render={dashboard} />\n    </Router>\n  );\n}\n\nfunction dashboard(props: any) { return <Dashboard {...props} /> }\n\nexport default App;\n\nexport type RouterProps = {\n  location: {\n    search: string\n  };\n}\n","import { ReportHandler } from 'web-vitals';\n\nconst reportWebVitals = (onPerfEntry?: ReportHandler) => {\n  if (onPerfEntry && onPerfEntry instanceof Function) {\n    import('web-vitals').then(({ getCLS, getFID, getFCP, getLCP, getTTFB }) => {\n      getCLS(onPerfEntry);\n      getFID(onPerfEntry);\n      getFCP(onPerfEntry);\n      getLCP(onPerfEntry);\n      getTTFB(onPerfEntry);\n    });\n  }\n};\n\nexport default reportWebVitals;\n","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport './index.scss';\nimport App from './App';\nimport reportWebVitals from './reportWebVitals';\n\nReactDOM.render(\n  <React.StrictMode>\n    <App />\n  </React.StrictMode>,\n  document.getElementById('root')\n);\n\n// If you want to start measuring performance in your app, pass a function\n// to log results (for example: reportWebVitals(console.log))\n// or send to an analytics endpoint. Learn more: https://bit.ly/CRA-vitals\nreportWebVitals();\n"],"sourceRoot":""}